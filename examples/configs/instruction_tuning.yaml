# Instruction fine-tuning â€” GPT-2 on alpaca-style generated data
#
# Prerequisites:
#   python examples/generate_sample_data.py
#
# Usage:
#   finetune-cli train --config examples/configs/instruction_tuning.yaml

model:
  name: "gpt2"
  device: "auto"
  torch_dtype: "float32"
  load_in_4bit: false
  load_in_8bit: false
  trust_remote_code: false

dataset:
  source: "local_file"
  path: "./data/instructions.jsonl"
  split: "train"
  max_samples: 300
  shuffle: true
  seed: 42
  text_columns:
    - "instruction"
    - "input"
    - "response"

tokenization:
  max_length: 256
  truncation: true
  padding: "max_length"
  add_special_tokens: true
  return_attention_mask: true

training:
  method: "instruction_tuning"
  output_dir: "./outputs/gpt2_instruction"
  num_epochs: 3
  batch_size: 4
  gradient_accumulation_steps: 4
  learning_rate: 0.0002
  weight_decay: 0.01
  warmup_ratio: 0.1
  lr_scheduler_type: "cosine"
  fp16: false
  bf16: false
  logging_steps: 10
  save_strategy: "epoch"
  evaluation_strategy: "no"
  seed: 42

lora:
  r: 8
  lora_alpha: 16
  lora_dropout: 0.1
  target_modules: null
  bias: "none"
  fan_in_fan_out: false
  init_lora_weights: true